<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo do Comportamento Seguro na Internet</title>
    <style>
        /* Estilos Gerais */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f8ff;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        h1 {
            color: #0056b3;
            text-shadow: 1px 1px 2px #ccc;
        }

        /* Painel de Controle do Jogo */
        .game-controls {
            background-color: #fff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            text-align: center;
            width: 90%;
            max-width: 800px;
        }

        #roll-dice-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        #roll-dice-btn:hover {
            background-color: #218838;
        }

        #roll-dice-btn:active {
            transform: scale(0.98);
        }

        #roll-dice-btn:disabled {
            background-color: #999;
            cursor: not-allowed;
        }

        .game-info {
            margin-top: 15px;
            font-size: 1.1em;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        #dice-result,
        #player-turn {
            background-color: #e9ecef;
            padding: 10px 20px;
            border-radius: 8px;
            min-width: 150px;
            /* Garante espaço para o texto "Sorteando..." */
        }

        /* Tabuleiro */
        .board {
            display: grid;
            grid-template-columns: repeat(8, 100px);
            grid-template-rows: repeat(5, 100px);
            gap: 5px;
            width: 840px;
            margin: 0 auto;
            position: relative;
        }

        .square {
            border: 2px solid #ccc;
            border-radius: 10px;
            font-size: 11px;
            font-weight: bold;
            padding: 5px;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            text-align: center;
        }

        .square .number {
            font-size: 1.5em;
            color: #555;
            align-self: flex-end;
        }

        .square.start {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .square.finish {
            background-color: #ffd1dc;
            border-color: #ffb6c1;
            font-size: 14px;
        }

        .square.good {
            background-color: #cce5ff;
            border-color: #b8daff;
        }

        .square.bad {
            background-color: #fff3cd;
            border-color: #ffeeba;
        }

        .square.normal {
            background-color: #e2e3e5;
        }

        /* Posicionamento da Trilha */
        .square[data-square="1"] {
            grid-column: 1;
            grid-row: 1;
        }

        .square[data-square="2"] {
            grid-column: 2;
            grid-row: 1;
        }

        .square[data-square="3"] {
            grid-column: 3;
            grid-row: 1;
        }

        .square[data-square="4"] {
            grid-column: 4;
            grid-row: 1;
        }

        .square[data-square="5"] {
            grid-column: 5;
            grid-row: 1;
        }

        .square[data-square="6"] {
            grid-column: 6;
            grid-row: 1;
        }

        .square[data-square="7"] {
            grid-column: 7;
            grid-row: 1;
        }

        .square[data-square="8"] {
            grid-column: 8;
            grid-row: 1;
        }

        .square[data-square="9"] {
            grid-column: 8;
            grid-row: 2;
        }

        .square[data-square="10"] {
            grid-column: 7;
            grid-row: 2;
        }

        .square[data-square="11"] {
            grid-column: 6;
            grid-row: 2;
        }

        .square[data-square="12"] {
            grid-column: 5;
            grid-row: 2;
        }

        .square[data-square="13"] {
            grid-column: 4;
            grid-row: 2;
        }

        .square[data-square="14"] {
            grid-column: 3;
            grid-row: 2;
        }

        .square[data-square="15"] {
            grid-column: 2;
            grid-row: 2;
        }

        .square[data-square="16"] {
            grid-column: 1;
            grid-row: 2;
        }

        .square[data-square="17"] {
            grid-column: 1;
            grid-row: 3;
        }

        .square[data-square="18"] {
            grid-column: 2;
            grid-row: 3;
        }

        .square[data-square="19"] {
            grid-column: 3;
            grid-row: 3;
        }

        .square[data-square="20"] {
            grid-column: 4;
            grid-row: 3;
        }

        .square[data-square="21"] {
            grid-column: 5;
            grid-row: 3;
        }

        .square[data-square="22"] {
            grid-column: 6;
            grid-row: 3;
        }

        .square[data-square="23"] {
            grid-column: 7;
            grid-row: 3;
        }

        .square[data-square="24"] {
            grid-column: 8;
            grid-row: 3;
        }

        .square[data-square="25"] {
            grid-column: 8;
            grid-row: 4;
        }

        .square[data-square="26"] {
            grid-column: 7;
            grid-row: 4;
        }

        .square[data-square="27"] {
            grid-column: 6;
            grid-row: 4;
        }

        .square[data-square="28"] {
            grid-column: 5;
            grid-row: 4;
        }

        .square[data-square="29"] {
            grid-column: 4;
            grid-row: 4;
        }

        .square[data-square="30"] {
            grid-column: 3;
            grid-row: 4;
        }

        .square[data-square="31"] {
            grid-column: 2;
            grid-row: 4;
        }

        .square[data-square="32"] {
            grid-column: 1;
            grid-row: 4;
        }

        .square[data-square="33"] {
            grid-column: 1;
            grid-row: 5;
        }

        .square[data-square="34"] {
            grid-column: 2;
            grid-row: 5;
        }

        .square[data-square="35"] {
            grid-column: 3;
            grid-row: 5;
        }

        .square[data-square="36"] {
            grid-column: 4;
            grid-row: 5;
        }

        .square[data-square="37"] {
            grid-column: 5;
            grid-row: 5;
        }

        .square[data-square="38"] {
            grid-column: 6;
            grid-row: 5;
        }

        #start-area {
            grid-column: 1 / 9;
            grid-row: 6;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ccc;
            background-color: #f8f9fa;
        }

        /* Peões dos Jogadores */
        .pawn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            position: absolute;
            transition: all 0.3s ease-in-out;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        #pawn1 {
            background-color: #dc3545;
            top: 10px;
            left: 10px;
        }

        #pawn2 {
            background-color: #007bff;
            top: 10px;
            right: 10px;
        }

        #pawn3 {
            background-color: #ffc107;
            bottom: 10px;
            left: 10px;
        }

        #pawn4 {
            background-color: #28a745;
            bottom: 10px;
            right: 10px;
        }

        /* Modal / Janela de Pop-up */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fff;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.25);
            animation: fadeIn 0.5s;
        }

        .modal-content.good {
            background-color: #d4edda;
        }

        .modal-content.bad {
            background-color: #f8d7da;
        }

        #modal-close-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            border-radius: 8px;
            border: none;
            background-color: #007bff;
            color: white;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>

<body>

    <h1>Jogo do Comportamento Seguro na Internet</h1>

    <div class="game-controls">
        <button id="roll-dice-btn">Lançar o Dado</button>
        <div class="game-info">
            <div id="player-turn">Vez do Jogador 1</div>
            <div id="dice-result">Dado: -</div>
        </div>
    </div>

    <div class="board"></div>
    <div id="start-area">
        <div id="pawn1" class="pawn"></div>
        <div id="pawn2" class="pawn"></div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title">Ação Especial!</h2>
            <p id="modal-text">Texto da ação aqui.</p>
            <button id="modal-close-btn">OK</button>
        </div>
    </div>


    <script>
        // --- CONFIGURAÇÃO DO JOGO ---
        const players = [
            { id: 1, position: 0, pawnElement: document.getElementById('pawn1'), color: 'Vermelho', skipTurn: false },
            { id: 2, position: 0, pawnElement: document.getElementById('pawn2'), color: 'Azul', skipTurn: false },
        ];

        const totalSquares = 38;
        let currentPlayerIndex = 0;
        let gameActive = true;

        const specialSquares = {
            4: { type: 'good', message: 'Conversou com seus pais sobre um desafio da internet. (ande 3 casas)', action: 'advance', value: 3 },
            8: { type: 'good', message: 'Denunciou um perfil que estava te ofendendo! (jogue novamente)', action: 'roll_again' },
            10: { type: 'bad', message: 'Não citou a fonte da lição que copiou da internet. (fique sem jogar)', action: 'skip_turn' },
            13: { type: 'good', message: 'Percebeu que aquela superpromoção era golpe! (ande 6 casas)', action: 'advance', value: 6 },
            16: { type: 'bad', message: 'Compartilhou postagem duvidosa. (fique sem jogar)', action: 'skip_turn' },
            19: { type: 'good', message: 'Bloqueou um perfil que estava pedindo fotos suas! (jogue novamente)', action: 'roll_again' },
            22: { type: 'bad', message: 'Postou uma mensagem com raiva, sem pensar. (fique sem jogar)', action: 'skip_turn' },
            25: { type: 'good', message: 'Saiu da internet e foi passear ou ler um livro. (ande 7 casas)', action: 'advance', value: 7 },
            28: { type: 'bad', message: 'Curtiu mensagem falando mal de alguém. (volte 4 casas)', action: 'back', value: 4 },
            31: { type: 'bad', message: 'Ficou até tarde jogando e dormiu na aula. (volte 9 casas)', action: 'back', value: 9 },
            34: { type: 'good', message: 'Ajudou alguém a ter um comportamento seguro na internet. (jogue novamente)', action: 'roll_again' },
            36: { type: 'bad', message: 'Não foi num passeio com medo de ficar sem internet. (volte 6 casas)', action: 'back', value: 6 }
        };

        const board = document.querySelector('.board');
        const rollBtn = document.getElementById('roll-dice-btn');
        const diceResultEl = document.getElementById('dice-result');
        const playerTurnEl = document.getElementById('player-turn');
        const modal = document.getElementById('modal');
        const modalContent = document.querySelector('.modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const modalCloseBtn = document.getElementById('modal-close-btn');

        function createBoard() {
            for (let i = 1; i <= totalSquares; i++) {
                const square = document.createElement('div');
                square.classList.add('square');
                square.dataset.square = i;
                const text = document.createElement('span');
                const number = document.createElement('span');
                number.classList.add('number');
                number.textContent = i;
                if (i === 1) {
                    square.classList.add('start'); text.textContent = 'Partida';
                } else if (i === totalSquares) {
                    square.classList.add('finish'); text.textContent = 'CHEGADA';
                } else if (specialSquares[i]) {
                    const rule = specialSquares[i]; square.classList.add(rule.type); text.textContent = rule.message;
                } else { square.classList.add('normal'); }
                square.appendChild(text); square.appendChild(number); board.appendChild(square);
            }
        }

        function updateUI() {
            const currentPlayer = players[currentPlayerIndex];
            playerTurnEl.textContent = `Vez do Jogador ${currentPlayer.id} (${currentPlayer.color})`;
            rollBtn.style.backgroundColor = getPlayerColor(currentPlayer.id);
        }

        function getPlayerColor(playerId) {
            const colors = { 1: '#dc3545', 2: '#007bff', 3: '#ffc107', 4: '#28a745' };
            return colors[playerId] || '#6c757d';
        }

        function movePawn(player) {
            const targetSquare = player.position > 0 ? board.querySelector(`.square[data-square="${player.position}"]`) : document.getElementById('start-area');
            if (targetSquare) { targetSquare.appendChild(player.pawnElement); }
        }

        function nextTurn() {
            currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
            if (players[currentPlayerIndex].skipTurn) {
                players[currentPlayerIndex].skipTurn = false;
                showModal('info', `O Jogador ${players[currentPlayerIndex].id} estava de castigo e perdeu a vez!`, nextTurn);
            } else { updateUI(); rollBtn.disabled = false; }
        }

        function showModal(type, message, callback) {
            modalTitle.textContent = 'Atenção!';
            modalContent.classList.remove('good', 'bad');
            if (type === 'good') {
                modalTitle.textContent = 'Parabéns!'; modalContent.classList.add('good');
            } else if (type === 'bad') {
                modalTitle.textContent = 'Cuidado!'; modalContent.classList.add('bad');
            } else if (type === 'win') { modalTitle.textContent = 'VITÓRIA!'; }
            modalText.textContent = message;
            modal.style.display = 'flex';
            modalCloseBtn.onclick = () => { modal.style.display = 'none'; if (callback) callback(); };
        }

        // --- FUNÇÃO DE AÇÃO EM CASA ESPECIAL (MODIFICADA) ---
        function handleSpecialSquare(player) {
            const squareRule = specialSquares[player.position];
            if (!squareRule) { nextTurn(); return; }

            showModal(squareRule.type, squareRule.message, () => {
                switch (squareRule.action) {
                    case 'advance':
                        // Inicia a animação de avanço
                        animateSpecialMove(player, squareRule.value);
                        break;
                    case 'back':
                        // Inicia a animação de retrocesso
                        animateSpecialMove(player, -squareRule.value);
                        break;
                    case 'skip_turn':
                        player.skipTurn = true;
                        nextTurn();
                        break;
                    case 'roll_again':
                        rollBtn.disabled = false;
                        updateUI();
                        break;
                }
            });
        }

        function checkWinCondition(player, callback) {
            if (player.position >= totalSquares) {
                gameActive = false;
                showModal('win', `O Jogador ${player.id} (${player.color}) venceu o jogo e se tornou um Cidadão Digital exemplar!`, () => {
                    rollBtn.textContent = "Jogar Novamente";
                    rollBtn.onclick = () => location.reload();
                    rollBtn.disabled = false;
                });
            } else { if (callback) callback(); }
        }

        rollBtn.addEventListener('click', () => {
            if (!gameActive) return;
            rollBtn.disabled = true;
            const finalRoll = Math.floor(Math.random() * 6) + 1;
            const animationInterval = setInterval(() => {
                diceResultEl.textContent = `Sorteando... ${Math.floor(Math.random() * 6) + 1}`;
            }, 80);
            setTimeout(() => {
                clearInterval(animationInterval);
                diceResultEl.textContent = `Dado: ${finalRoll}`;
                const currentPlayer = players[currentPlayerIndex];
                animateMoveStepByStep(currentPlayer, finalRoll);
            }, 2000);
        });

        // --- FUNÇÃO DE ANIMAÇÃO DO DADO ---
        function animateMoveStepByStep(player, steps) {
            if (steps <= 0) {
                setTimeout(() => checkWinCondition(player, () => handleSpecialSquare(player)), 400);
                return;
            }
            player.position++;
            if (player.position > totalSquares) player.position = totalSquares;
            movePawn(player);
            if (player.position >= totalSquares) {
                setTimeout(() => checkWinCondition(player), 400);
                return;
            }
            setTimeout(() => animateMoveStepByStep(player, steps - 1), 400);
        }

        // --- NOVA FUNÇÃO DE ANIMAÇÃO PARA CASAS ESPECIAIS ---
        function animateSpecialMove(player, steps) {
            const direction = Math.sign(steps); // 1 para frente, -1 para trás
            let stepsLeft = Math.abs(steps);

            function moveOneStep() {
                if (stepsLeft <= 0) {
                    // Animação terminou, verifica vitória e passa o turno
                    checkWinCondition(player, nextTurn);
                    return;
                }

                player.position += direction;
                player.position = Math.max(1, Math.min(player.position, totalSquares)); // Garante que não saia do tabuleiro
                movePawn(player);
                stepsLeft--;

                // Se chegar ao final durante o avanço, para e declara a vitória
                if (player.position >= totalSquares && direction > 0) {
                    checkWinCondition(player);
                    return;
                }

                setTimeout(moveOneStep, 400); // Continua para o próximo passo
            }

            moveOneStep(); // Inicia o primeiro passo
        }

        window.onload = () => {
            createBoard();
            players.forEach(p => movePawn(p));
            updateUI();
        };
    </script>
    <footer style="font-size: 8px;">Criado por Gabriel Caldas - Instituto de Computação - UFRJ - Para a SNCT 2025 -
        Inspirado em https://internetsegura.br/ | Licenciado em Creative Commons (CC BY-NC-ND 4.0)</footer>
</body>

</html>